/*! Copyright (c) 2023 Mediarithmics; All Rights Reserved */
(()=>{var n={2705:(t,e,n)=>{n=n(5639).Symbol;t.exports=n},6874:t=>{t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},4636:(t,e,n)=>{var d=n(2545),l=n(5694),p=n(1469),h=n(4144),f=n(5776),g=n(6719),_=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n,i=p(t),o=!i&&l(t),r=!i&&!o&&h(t),s=!i&&!o&&!r&&g(t),a=i||o||r||s,c=a?d(t.length,String):[],u=c.length;for(n in t)!e&&!_.call(t,n)||a&&("length"==n||r&&("offset"==n||"parent"==n)||s&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||f(n,u))||c.push(n);return c}},4865:(t,e,n)=>{var o=n(9465),r=n(7813),s=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var i=t[e];s.call(t,e)&&r(i,n)&&(void 0!==n||e in t)||o(t,e,n)}},9465:(t,e,n)=>{var i=n(8777);t.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},4239:(t,e,n)=>{var i=n(2705),o=n(9607),r=n(2333),s=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(s&&s in Object(t)?o:r)(t)}},9454:(t,e,n)=>{var i=n(4239),o=n(7005);t.exports=function(t){return o(t)&&"[object Arguments]"==i(t)}},8458:(t,e,n)=>{var i=n(3560),o=n(5346),r=n(3218),s=n(346),a=/^\[object .+?Constructor\]$/,c=Function.prototype,n=Object.prototype,c=c.toString,n=n.hasOwnProperty,u=RegExp("^"+c.call(n).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!r(t)||o(t))&&(i(t)?u:a).test(s(t))}},8749:(t,e,n)=>{var i=n(4239),o=n(1780),r=n(7005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return r(t)&&o(t.length)&&!!s[i(t)]}},313:(t,e,n)=>{var o=n(3218),r=n(5726),s=n(3498),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!o(t))return s(t);var e,n=r(t),i=[];for(e in t)("constructor"!=e||!n&&a.call(t,e))&&i.push(e);return i}},5976:(t,e,n)=>{var i=n(6557),o=n(5357),r=n(61);t.exports=function(t,e){return r(o(t,e,i),t+"")}},6560:(t,e,n)=>{var i=n(5703),o=n(8777),n=n(6557);t.exports=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:n},2545:t=>{t.exports=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}},7518:t=>{t.exports=function(e){return function(t){return e(t)}}},8363:(t,e,n)=>{var u=n(4865),d=n(9465);t.exports=function(t,e,n,i){var o=!n;n=n||{};for(var r=-1,s=e.length;++r<s;){var a=e[r],c=i?i(n[a],t[a],a,n,t):void 0;void 0===c&&(c=t[a]),(o?d:u)(n,a,c)}return n}},4429:(t,e,n)=>{n=n(5639)["__core-js_shared__"];t.exports=n},1463:(t,e,n)=>{var i=n(5976),c=n(6612);t.exports=function(a){return i(function(t,e){var n=-1,i=e.length,o=1<i?e[i-1]:void 0,r=2<i?e[2]:void 0,o=3<a.length&&"function"==typeof o?(i--,o):void 0;for(r&&c(e[0],e[1],r)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var s=e[n];s&&a(t,s,n,o)}return t})}},8777:(t,e,n)=>{var i=n(852),n=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=n},1957:(t,e,n)=>{n="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=n},852:(t,e,n)=>{var i=n(8458),o=n(7801);t.exports=function(t,e){return e=o(t,e),i(e)?e:void 0}},9607:(t,e,n)=>{var i=n(2705),n=Object.prototype,r=n.hasOwnProperty,s=n.toString,a=i?i.toStringTag:void 0;t.exports=function(t){var e=r.call(t,a),n=t[a];try{var i=!(t[a]=void 0)}catch(t){}var o=s.call(t);return i&&(e?t[a]=n:delete t[a]),o}},7801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},5776:t=>{var i=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&i.test(t))&&-1<t&&t%1==0&&t<e}},6612:(t,e,n)=>{var o=n(7813),r=n(8612),s=n(5776),a=n(3218);t.exports=function(t,e,n){if(!a(n))return!1;var i=typeof e;return!!("number"==i?r(n)&&s(e,n.length):"string"==i&&e in n)&&o(n[e],t)}},5346:(t,e,n)=>{var n=n(4429),i=(n=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!i&&i in t}},5726:t=>{var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},3498:t=>{t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},1167:(t,e,n)=>{t=n.nmd(t);var n=n(1957),e=e&&!e.nodeType&&e,i=e&&t&&!t.nodeType&&t,o=i&&i.exports===e&&n.process,n=function(){try{var t=i&&i.require&&i.require("util").types;return t?t:o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=n},2333:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},5357:(t,e,n)=>{var c=n(6874),u=Math.max;t.exports=function(r,s,a){return s=u(void 0===s?r.length-1:s,0),function(){for(var t=arguments,e=-1,n=u(t.length-s,0),i=Array(n);++e<n;)i[e]=t[s+e];for(var e=-1,o=Array(s+1);++e<s;)o[e]=t[e];return o[s]=a(i),c(r,this,o)}}},5639:(t,e,n)=>{var i=n(1957),n="object"==typeof self&&self&&self.Object===Object&&self,n=i||n||Function("return this")();t.exports=n},61:(t,e,n)=>{var i=n(6560),i=n(1275)(i);t.exports=i},1275:t=>{var r=Date.now;t.exports=function(n){var i=0,o=0;return function(){var t=r(),e=16-(t-o);if(o=t,0<e){if(800<=++i)return arguments[0]}else i=0;return n.apply(void 0,arguments)}}},346:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},3045:(t,e,n)=>{var i=n(8363),o=n(1463),r=n(1704),o=o(function(t,e){i(e,r(e),t)});t.exports=o},5703:t=>{t.exports=function(t){return function(){return t}}},7813:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},2205:(t,e,n)=>{t.exports=n(3045)},6557:t=>{t.exports=function(t){return t}},5694:(t,e,n)=>{var i=n(9454),o=n(7005),n=Object.prototype,r=n.hasOwnProperty,s=n.propertyIsEnumerable,i=i(function(){return arguments}())?i:function(t){return o(t)&&r.call(t,"callee")&&!s.call(t,"callee")};t.exports=i},1469:t=>{var e=Array.isArray;t.exports=e},8612:(t,e,n)=>{var i=n(3560),o=n(1780);t.exports=function(t){return null!=t&&o(t.length)&&!i(t)}},4144:(t,e,n)=>{t=n.nmd(t);var i=n(5639),o=n(5062),n=e&&!e.nodeType&&e,e=n&&t&&!t.nodeType&&t,i=e&&e.exports===n?i.Buffer:void 0,i=i?i.isBuffer:void 0;t.exports=i||o},3560:(t,e,n)=>{var i=n(4239),o=n(3218);t.exports=function(t){return!!o(t)&&("[object Function]"==(t=i(t))||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t)}},1780:t=>{t.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},3218:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},6719:(t,e,n)=>{var i=n(8749),o=n(7518),n=n(1167),n=n&&n.isTypedArray,i=n?o(n):i;t.exports=i},1704:(t,e,n)=>{var i=n(4636),o=n(313),r=n(8612);t.exports=function(t){return r(t)?i(t,!0):o(t)}},5062:t=>{t.exports=function(){return!1}},2707:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o,r,s,a,c,u,d=n(5737),l=n(7238),p=n(2461),h=n(6701),f=n(971),e=n(2228),i=i(n(3045)),n="mics_debug_tag",n="1"===(new h.Cache).get(n)||"1"===(0,e.readCookie)(n)||!1,g=(0,p.Console)("tag",n),p=window.navigator.userAgent;function _(t){return void 0!==t.context}function v(e){f.mics._names.forEach(function(t){e(t)})}function y(e){v(function(t){t=f.mics[t];_(t)&&e(t)})}/googlebot|bingbot|yandexbot|baiduspider/i.test(p)||(o=!1,r=(new Date).getTime(),new d.AdServer(n).setDFPTargeting(),d={_tagVersion:"2.0.20230214-build-115-rev-40f9d4a",_call:function(t,e,n){return i=t,f.mics._names.filter(function(t){t=f.mics[t];return _(t)&&(void 0!==t.options.site_token&&i===t.options.site_token||void 0!==t.options.datamart_token&&i===t.options.datamart_token)}).map(function(t){return f.mics[t]}).forEach(function(t){void 0!==t[e]&&t[e].apply(t,n)});var i},_setConfig:function(e){return y(function(t){return t.setConfig(e)})},_markConfigAsLoaded:function(){return y(function(t){return t.markConfigAsLoaded()})},_upsertAdvertisingCookie:function(e,n,i,o){return y(function(t){return t.upsertAdvertisingCookie(e,n,i,o)})},_declareAdvertisingCookieConsent:function(e){return y(function(t){return t.declareAdvertisingCookieConsent(e)})},_revokeAdvertisingCookieConsent:function(){return y(function(t){return t.revokeAdvertisingCookieConsent()})},_setEvaluator:function(e){return y(function(t){return t.setEvaluator(e)})},_setDeviceInfo:function(e){return y(function(t){return t.setDeviceInfo(e)})},_setSegmentDefinition:function(e){return y(function(t){return t.setSegmentDefinition(e)})},_setOperatorId:function(e,n){return y(function(t){return t.setOperatorId(e,n)})},_setUAID:function(e,n,i){return y(function(t){return t._setUAID(e,n,i)})},_reset:function(t){o&&!t||(o=!0,g.info("mics.reset"),y(function(t){return t._reset()}),s._startTime=r)}},(s=f.mics)._tagVersion||(0,i.default)(s,d),c=n,u=(a=s)._queue,v(function(t){a[t]&&_(a[t])||(a[t]=new l.TagObject(t,c),window[t]=a[t])}),v(function(t){!function(t,e){var n=f.mics[t];for(;e.length;){var i=e.shift();i&&_(n)&&(g.debug("executing ",i,"on",t),n.callMicsMethod(i.method,i.args))}}(t,u[t])}),d={_call:d._call,_setConfig:d._setConfig,_markConfigAsLoaded:d._markConfigAsLoaded,_upsertAdvertisingCookie:d._upsertAdvertisingCookie,_setSegmentDefinition:d._setSegmentDefinition,_setDeviceInfo:d._setDeviceInfo,_setEvaluator:d._setEvaluator},window.mics=window.mics||{},(0,i.default)(window.mics,d),window.addEventListener&&window.addEventListener("beforeunload",function(){y(function(t){return t.pageQuit()})},!1))},5737:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AdServer=void 0;var i=n(6701),o=n(2461),n=(r.prototype.setDFPTargeting=function(){var n=this;try{window.googletag&&window.googletag.cmd?window.googletag.cmd.push(function(){var t=n.cache.get("mics_sgmts"),t=t&&"string"==typeof t?JSON.parse(t):void 0,e=t||{};Object.keys(e).forEach(function(t){window.googletag.pubads().setTargeting("mics_"+t,e[t].map(String))})}):this.console.info("DFP is not present")}catch(t){this.console.error("error setting DFP",t)}},r);function r(t){this.debug=t,this.cache=new i.Cache(!0),this.console=(0,o.Console)("AdServer",t),this.console.info("Starting Ad Server Connection")}e.AdServer=n},6701:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cache=void 0;var i=n(2461),n=(o.prototype.get=function(t){if(this.canUseLocalStorage)return window.localStorage.getItem(t)||void 0},o.prototype.store=function(t,e){this.canUseLocalStorage&&window.localStorage.setItem(t,e)},o.prototype.remove=function(t){this.canUseLocalStorage&&window.localStorage.removeItem(t)},o.prototype.isLocalStorageEnabled=function(){try{var t="is_enabled";return localStorage.setItem(t,"true"),"true"===localStorage.getItem(t)}catch(t){return this.debug&&console.log("localStorage is not enabled",t),!1}},o);function o(t){this.debug=!!t,this.console=(0,i.Console)(o.name,this.debug),this.canUseLocalStorage=this.isLocalStorageEnabled()}e.Cache=n},2461:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Console=void 0;var a=n(971);e.Console=function(r,s){return function(t){var e,n={};for(e in t)n[t[e]]=function(o){return function(){if(s&&window.console&&Object.keys(window.console).includes(o))try{var t=Array.prototype.slice.apply(arguments),e=(new Date).getTime(),n=(0,a.durationFromSnippetStart)(e),i=n?n/1e3:0;t.unshift("ctx:".concat(r,"]")),t.unshift("[mics "+i.toFixed(3)+"s"),window.console[o].apply(window.console,t)}catch(t){window.console.log(t)}}}(t[e]);return n}("log debug info warn error".split(" "))}},2228:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(e.updateCookiesExpirationStartingWith=e.deleteCookiesStartingWith=e.readCookie=void 0,n(2461).Console)("CookieHelper",!1);function i(t,e){if(t&&e)for(var n=document.cookie.split(";"),i=0;i<n.length;i++){var o=n[i].replace(/ /g,"").split("=");o[0].startsWith(t)&&(r.debug("update cookie",o[0],o[1]),document.cookie=o[0]+"="+o[1]+";path=/;expires="+e)}}e.readCookie=function(t){for(var e=document.cookie.split(";"),n=0;n<e.length;n++){var i=e[n].replace(/ /g,"").split("=");if(i[0]===t)return r.debug("found cookie",i[0],i[1]),i[1]}},e.deleteCookiesStartingWith=function(t){var e=new Date;e.setTime(0),i(t,e.toUTCString())},e.updateCookiesExpirationStartingWith=i},517:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CookieMatcher=void 0;var s=n(5098),a=n(2461),n=(i.prototype.setOperators=function(t){this.operators=t},i.prototype.setIsTcfEnabled=function(t){this.isTcfEnabled=t},i.prototype.end=function(){return this.gatherIdEnd},i.prototype.panicCallback=function(t){this.panicFn=t},i.prototype.setEtid=function(t){this.etid=t,this.finishIfPossible(!1)},i.prototype.isCookieMatchingAuthorizedByTcfApi=function(){return!this.isTcfEnabled||!!(this.tcfVendorMicsConsent&&this.tcfPurposesConsents||!1===this.gdprApplies)},i.prototype.destroy=function(){window.clearTimeout(this.watchDog)},i);function i(t,e,n,i,o){var r=this;this.gatherOperatorsIds=function(){r.console.info("gatherOperatorsIds",r.operators);for(var t=0;t<r.operators.length;t++)r.gatherId(r.operators[t]);0<r.timeout&&(r.watchDog=window.setTimeout(function(){r._timeout()},r.timeout))},this.gatherId=function(e){var t=r.options.gather_operator_id_url+"?opid="+e;r.isTcfEnabled&&(t=t+"&gdpr="+(!1===r.gdprApplies?"0":"1")),r.tcfstr&&r.isTcfEnabled&&(t=t+"&gdpr_consent="+r.tcfstr),r.options.override_transport&&r.options.override_transport(t),(0,s.loadScript)(t,function(t){t&&(r.console.info("error while gather_id",e),r.setOperatorId(e,null))})},this.setOperatorId=function(t,e){r.isCookieMatchingAuthorizedByTcfApi()&&(e?r.retrievedIds.includes(e)||(r.console.log("setId("+t+", "+e+")"),r.retrievedIds.push(e),r.finished=r.retrievedIds.length===r.operators.length,r.finishIfPossible(!1)):r.finishIfPossible(!1))},this.finishIfPossible=function(t){if(r.console.log("try to finish, panicMode:",t,"etid:",r.etid,"finished",r.finished),r.finished||t){r.gatherIdEnd=(new Date).getTime();for(var e=[];r.retrievedIds.length;){var n=r.retrievedIds.shift();n&&e.push(n)}r.console.log("finishing.");t=r.options.cookie_matching_url+"?";r.etid&&(t=t+"etid="+r.etid+"&"),r.isTcfEnabled&&(t=t+"gdpr="+(!1===r.gdprApplies?"0":"1")+"&"),r.tcfstr&&(t=t+"gdpr_consent="+r.tcfstr+"&"),r.options.site_token&&(t=t+"$site_token="+r.options.site_token+"&"),t=(t=r.options.datamart_token?t+"$dat_token="+r.options.datamart_token+"&":t)+"utidl="+e.join(","),r.options.override_transport&&r.options.override_transport(t),(0,s.loadScript)(t,function(t){t&&r.panicFn&&(r.console.info("failed to load get_id"),r.panicFn("$get_id_failed"))}),r.ran=!0,r.destroy()}},this._timeout=function(){r.isCookieMatchingAuthorizedByTcfApi()?r.finishIfPossible(!0):r.destroy()},this.finished=!1,this.ran=!1,this.operators=[],this.retrievedIds=[],this.timeout=t.gather_id_timeout_ms,this.watchDog=void 0,this.options=t,this.console=(0,a.Console)("CookieMatcher",t.debug),this.tcfstr=o,this.tcfVendorMicsConsent=e,this.tcfPurposesConsents=n,this.gdprApplies=i}e.CookieMatcher=n},4471:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CurrentPage=void 0;var i=n(2228),n=(o.prototype._parseSearch=function(t){for(var e,n,i=t.substring(1).split("&"),o={},r=0;r<i.length;r++)e=(n=i[r].split("="))[0],n=n[1],o[e]=decodeURIComponent(n).replace(/\+/g," ");return o},o.prototype.markConfigAsLoaded=function(){this.confLoaded=!0},o.prototype.isConfLoaded=function(){return this.confLoaded},o.prototype.readPage=function(){this.updatePage(),!this.options.local_cookie_name||(t=(0,i.readCookie)(this.options.local_cookie_name))&&(this.properties.raw_cookie=t);var t=(0,i.readCookie)("mics_uaid");t&&(this.properties.$uaid=t);t=(0,i.readCookie)("mics_vid");t&&this.userIdentifierHolder.addUserAgentIdentifier(t);t=(0,i.readCookie)("mics_lts"),t=t&&parseInt(t,10);t&&!isNaN(t)&&(this.properties.$lts=t)},o.prototype.updatePage=function(){this.properties.$referrer=document.referrer,this.properties.$url=""+document.location,this._setUtm(),this._setGdpr()},o.prototype._setUtm=function(){for(var t="utm_source utm_medium utm_term utm_content utm_campaign".split(" "),e=this._parseSearch(window.location.search),n=0;n<t.length;n++){var i=t[n];e[i]&&(this.properties["$"+i]=e[i])}},o.prototype._setGdpr=function(){var t;window.__tcfapi&&(t=!(this.properties.$tcfapi=1)===this.gdprApplies?"0":"1",this.properties.$gdpr=t),this.tcfstr&&(this.properties.$gdpr_consent=this.tcfstr)},o.prototype.getVid=function(){return this.userIdentifierHolder.findVectorIdLongValue()},o.prototype.getLts=function(){return this.properties.$lts},o.prototype.getCookie=function(){return this.properties.$uaid},o.prototype.updateUAID=function(t,e){var n=new Date;n.setTime(n.getTime()+24*this.options.cookie_max_age_in_days*60*60*1e3),t&&(this.userIdentifierHolder.addUserAgentIdentifier(t),document.cookie="mics_vid="+encodeURIComponent(t)+";expires="+n.toUTCString()+";path=/"),e&&(this.properties.$lts=e,document.cookie="mics_lts="+encodeURIComponent(e)+";expires="+n.toUTCString()+";path=/")},o);function o(t,e,n,i){this.properties={},this.options=t,this.confLoaded=!1,this.tcfstr=i,this.gdprApplies=n,this.userIdentifierHolder=e}e.CurrentPage=n},8146:(t,n,e)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventPusher=n.DEVICE_TECHNICAL_ID_MAPPING_EVENT_NAME=void 0;var c=e(2461),i=e(5098),s=e(971);function a(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}n.DEVICE_TECHNICAL_ID_MAPPING_EVENT_NAME="$device_technical_id_mapping";o.prototype.sendCallQueue=function(t,e){for(var n=this.callQueue,i=e||{};n.length;){var o=(0,s.durationFromSnippetStart)((new Date).getTime());o&&(i.$delay={$push:o,$start:(0,s.durationFromSnippetStart)(this.tagStart),$gather_id_end:(0,s.durationFromSnippetStart)(this.cookieMatcher.end()),$beacon:t===this.beacon});var r=a(r=n.shift()||{},this.globalProperties);r=a(r,i),r=a(r,this.userIdentifierHolder.getEventPusherProperties()),this.console.info("pushing",r);o=this.endPointUrl+"?"+this.generateHttpQuery(r);this.eventsRunning++,t(o,this.pixelSentCallback(this)),this.userPoint&&this.userPoint.addEvent(r)}this.panicMode||(this.console.info("complete before panicMode, clearing watchDog"),this.clearWatchDog())},o.prototype.clearWatchDog=function(){this.watchDog&&(this.console.log("clearing watchdog"),window.clearTimeout(this.watchDog),this.watchDog=void 0)},o.prototype.setPanicCallback=function(t){this.panicFn=t},o.prototype.triggerCallsIfPossible=function(){var t,e=this;this.console.info("trigger calls if possible: currentPage:",this.currentPage,"panicMode:",this.panicMode,", global:",this.globalProperties,"callQueue:",this.callQueue,"userIdentfiers:",this.userIdentifierHolder.userIdentifiers),(this.currentPage&&this.currentPage.isConfLoaded()&&this.userIdentifierHolder.hasIdentifiers()||this.panicMode)&&(this.userIdentifierHolder.onNewIdentifier=function(t){e.push(n.DEVICE_TECHNICAL_ID_MAPPING_EVENT_NAME,t.toMappingEvent())},t={},this.panicMode&&this.panicReason&&(t.$error=this.panicReason),this.sendCallQueue(this.transportFunction||i.sendWithBeaconOrWithLoadPixel,t))},o.prototype.setUserpoint=function(t){this.userPoint=t},o.prototype.pixelSentCallback=function(n){return function(t,e){if(t?(n.eventsRunning--,n.console.info("error with",t)):(n.console.info("successfully sent",e),n.eventsRunning--),n.finishedCallbackFunction&&0===n.eventsRunning){n.console.info("calling callback function: eventsRunning:",n.eventsRunning,"errors:",n.errorEvents);try{n.finishedCallbackFunction.apply(0===n.errorEvents.length)}catch(t){n.console.error("error has occurred while calling callback function",t)}}}},o.prototype.pushDefault=function(){this.push("$page_view",void 0)},o.prototype.push=function(t,e){if(!this.currentPage)throw new Error("mics is not initialized, call mics.init(YOUR_TOKEN) first !");e=e||{},this.currentPage.properties.path!=document.location&&this.currentPage.updatePage(),(e=a(e,this.currentPage.properties)).$ev=t,this.callQueue.push(e),this.triggerCallsIfPossible()},o.prototype.addProperties=function(t){this.globalProperties=a(this.globalProperties,t),this.console.info("properties: ",this.globalProperties)},o.prototype.generateHttpQuery=function(t){var e,n=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&"object"!=typeof t[e]?n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e])):"object"==typeof t[e]&&"object"==typeof JSON&&n.push(encodeURIComponent(e)+"=jso-"+encodeURIComponent(JSON.stringify(t[e])));return n.join("&")},o.prototype.panic=function(t){this.console.info("switching to panic mode ! reason:",t),this.panicMode=!0,this.panicReason=t,this.triggerCallsIfPossible()},o.prototype.onFinish=function(t,e){this.finishedCallbackFunction=t,this.setWatchDog(e)},o.prototype.beacon=function(t){navigator.sendBeacon(t)},o.prototype.pageQuit=function(){for(this.console.log("page is unloading"),this.console.log("send call queue with navigator.beacon ("+this.errorEvents.length+" events)");this.errorEvents.length;)this.beacon(this.errorEvents.shift());0<this.eventsRunning&&this.push("$quit_while_running",void 0),this.sendCallQueue(this.beacon,{$error:"page_quit"})},e=o;function o(t,e,n,i,o,r,s){var a=this;this.callQueue=[],this.setWatchDog=function(t){a.console.info("setup watchdog timer to ",t),a.clearWatchDog(),a.watchDog=setTimeout(function(){a.panic("$count_down_1")},t)},this.context=t,this.console=(0,c.Console)("EventPusher-"+t,r.debug),this.console.info("new EventPusher()"),this.callQueue=[],this.currentPage=n,this.transportFunction=r.overrideTransport,this.cookieMatcher=i,this.userPoint=o,this.tagStart=e,this.globalProperties={},this.eventsRunning=0,this.endPointUrl=r.endPointUrl,this.panicMode=!1,this.errorEvents=[],this.options=r,this.userIdentifierHolder=s,this.userIdentifierHolder.onNewIdentifier=function(){a.triggerCallsIfPossible()}}n.EventPusher=e},4836:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processExternalFeedsWith=e.processExternalFeeds=void 0;var s=n(5098),o=864e5;function a(t){var n={s:(t=t).s,hc:t.hc,c:t.c,p:t.p||o,st:t.st,dn:t.dn,cb:function(t){if(t&&"function"==typeof t)return t;return function(t,e){}}(t.cb),vid:t.vid,ot:t.ot},i=JSON.parse(n.s.getItem("_mediarithmics")),t=(i=i||{})[n.st];(!t||n.c.now()-t.lastFeedRefreshDate>n.p)&&(t="https://"+n.dn+"/v1/sites/"+n.st+"/external_feeds",n.vid&&(t=t+"?"+encodeURIComponent("$vid")+"="+encodeURIComponent(n.vid)),(n.ot||n.hc.get)(t,function(t,e){t?n.cb(t,null):!function(t){try{var e=JSON.parse(t);return Array.isArray(e.scripts)&&Array.isArray(e.feeds)}catch(t){return!1}}(e)?n.cb(null,e):(e=JSON.parse(e),i[n.st]={lastFeedRefreshDate:n.c.now()},n.s.setItem("_mediarithmics",JSON.stringify(i)),e.scripts.map(function(t){var e;"INLINE"===t.type?((e=document.createElement("script"))[void 0===e.innerText?"textContent":"innerText"]=t.inner,document.head.appendChild(e)):"SRC"===t.type?((e=document.createElement("script")).src=t.source,document.head.appendChild(e)):"IMG"===t.type&&n.hc.loadPixel(t.source,void 0)}),n.cb(null,e.feeds))}))}e.processExternalFeeds=function(t,e,n,i,o,r){a({s:window.localStorage?localStorage:{setItem:function(t,e){return null},getItem:function(t){return null}},hc:{get:s.get,loadPixel:s.loadPixel},c:Date,p:t,st:e,dn:n,cb:i,vid:o,ot:r})},e.processExternalFeedsWith=a},971:function(t,e){"use strict";var n=this&&this.__rest||function(t,e){var n={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]]);return n};Object.defineProperty(e,"__esModule",{value:!0}),e.durationFromSnippetStart=e.mics=void 0;var i,o=window.scimhtiraidem;if(!(o=!window.scimhtiraidem&&window.mics&&void 0!==window.mics._snippetVersion?{_queue:{mics:(i=window.mics)._queue},_names:["mics"],_snippetVersion:i._snippetVersion,_startTime:i._startTime,mics:n(i,["_queue","_snippetVersion","_startTime"])}:o))throw new Error("mics is not defined. Did you used the provided snippet ?");var r=o;e.mics=r,window.scimhtiraidem=r,e.durationFromSnippetStart=function(t){return t&&r&&t-r._startTime}},8902:function(t,n,e){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,s,a,c){return new(a=a||Promise)(function(n,e){function i(t){try{r(c.next(t))}catch(t){e(t)}}function o(t){try{r(c.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,o)}r((c=c.apply(t,s||[])).next())})},r=this&&this.__generator||function(n,i){var o,r,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(s=2&e[0]?r.return:e[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;switch(r=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],r=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ID5_REGISTRY_KEY=n.ID5_CONFIG_OVERRIDE_STORAGE_KEY=n.MICS_PARTNER_ID=n.ID5_CDN_URL=void 0;var s=e(5098),a=e(2461),c=e(6701);n.ID5_CDN_URL="https://cdn.id5-sync.com/api/1.0/id5-api.js",n.MICS_PARTNER_ID=18,n.ID5_CONFIG_OVERRIDE_STORAGE_KEY="mics_id5_config_override",n.ID5_REGISTRY_KEY=4;u.prototype.loadId5ApiJs=function(){return o(this,void 0,void 0,function(){var e;return r(this,function(t){switch(t.label){case 0:return[4,Promise.resolve(this.id5Api)];case 1:if(t.sent())return[3,5];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,(0,s.loadScriptAsync)(n.ID5_CDN_URL)];case 3:return t.sent(),this.console.info("Loaded ".concat(n.ID5_CDN_URL)),this.id5Api=window.ID5,[3,5];case 4:return e=t.sent(),this.console.error("Could not load ID5 API",e),[3,5];case 5:return this.id5Api&&this.id5Api.loaded!==this.id5ApiLoadedAndReady&&(this.console.info("ID5.loaded=".concat(this.id5Api.loaded)),this.id5ApiLoadedAndReady=this.id5Api.loaded),[2]}})})},u.prototype.getID5ConfigOverride=function(){var e=this.cache.get(n.ID5_CONFIG_OVERRIDE_STORAGE_KEY);if(e)try{var t=JSON.parse(e);return this.console.log("ID5 config override found : ".concat(JSON.stringify(e))),t}catch(t){this.console.error("Cannot parse ID5 config override : ".concat(e))}return{}},u.prototype.initializeApi=function(){var t,e=this;!this.id5Status&&this.id5Api&&this.id5ApiLoadedAndReady&&(t=i(i({partnerId:n.MICS_PARTNER_ID},this.initialId5ApiConfig||{}),this.getID5ConfigOverride()),this.console.info("Initialize ID5 Api with config ".concat(JSON.stringify(t))),this.id5Api.debug=this.debug,this.id5Status=this.id5Api.init(t).onUpdate(function(t){e.console.log("ID5 ID updated callback",t),e.setId5UniversalId(t.getUserId())}),this.id5Status||this.console.warn("ID5 Api not initialized"))},u.prototype.setId5UniversalId=function(t){t&&"0"!==t&&(this.console.info("Setting ID5 Id = ".concat(t)),this.id5UniversalId=t,t="net:".concat(n.ID5_REGISTRY_KEY,":").concat(t),this.userIdentifierHolder.addUserAgentIdentifier(t))},u.prototype.startGathering=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:return this.console.info("Start gathering ID5 Id"),[4,this.loadId5ApiJs()];case 1:return t.sent(),this.initializeApi(),[2]}})})},e=u;function u(t){this.id5ApiLoadedAndReady=!1;var e=t.context,n=t.userIdentifierHolder,i=t.debug,t=t.initialId5ApiConfig;this.debug=i,this.userIdentifierHolder=n,this.console=(0,a.Console)("ID5IdGatherer-".concat(e),i),this.initialId5ApiConfig=t,this.cache=new c.Cache(i),this.id5Api=window.ID5,this.startGathering()}n.default=e},5098:(t,e)=>{"use strict";function n(e,n){var t=document.createElement("img");t.style.display="none",t.style.width=t.style.height="0px",n&&(t.onload=function(){n(void 0,e)},t.onerror=function(){var t=new Error("error while loading "+e);n(t,e)}),t.setAttribute("src",e)}function o(e,n){var t,i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",e),i.setAttribute("async","true"),n&&(i.onload=function(){n(void 0,e)},i.onerror=function(){var t=new Error("error while loading "+e);n(t,void 0)}),null!==(t=document.getElementsByTagName("script")[0].parentNode)&&void 0!==t&&t.appendChild(i)}Object.defineProperty(e,"__esModule",{value:!0}),e.sendWithBeaconOrWithLoadPixel=e.get=e.loadScriptAsync=e.loadScript=e.loadPixel=void 0,e.loadPixel=n,e.loadScript=o,e.loadScriptAsync=function(t){return new Promise(function(n,i){o(t,function(t,e){t&&i(t),n()})})},e.get=function(e,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){var t;4===i.readyState&&(200===i.status?n(void 0,i.responseText):(t=new Error("error while GETting: "+e),n(t,void 0)))},i.open("GET",e,!0),i.withCredentials=!0,i.send(null)},e.sendWithBeaconOrWithLoadPixel=function(t,e){if(!navigator.sendBeacon)return n(t,e);e(navigator.sendBeacon(t)?void 0:new Error("Error while calling "+t+"with sendBeacon()"),t)}},7238:function(t,e,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},r=this&&this.__awaiter||function(t,s,a,c){return new(a=a||Promise)(function(n,e){function i(t){try{r(c.next(t))}catch(t){e(t)}}function o(t){try{r(c.throw(t))}catch(t){e(t)}}function r(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,o)}r((c=c.apply(t,s||[])).next())})},s=this&&this.__generator||function(n,i){var o,r,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(s=2&e[0]?r.return:e[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,e[1])).done)return s;switch(r=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,r=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(n,a)}catch(t){e=[6,t],r=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TagObject=void 0;var c=n(6701),a=n(517),u=n(2461),d=n(4471),l=n(5098),p=n(8146),h=n(4836),f=n(971),g=n(8713),_=n(2228),v=o(n(2205)),y=o(n(8902)),m=o(n(4951));function I(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var n="https://cookie-matching.mediarithmics.com",b="mics_user_consent",w="mics_consent_ts",E=["VISIT","TOUCH"],P=(new Date).getTime(),A={domain_id:1,cookie_matching_url:n+"/v1/getids",gather_operator_id_url:n+"/v1/gather_id",get_id_path:"/v1/get_id",domain_name:"events.mediarithmics.com",protocol:"https://",events_path:"/v1/visits/pixel",config_server_path:"/v1/conf.js",cookie_max_age_in_days:365,cookie_refresh_in_days:10,local_cookie_name:void 0,gather_id_timeout_ms:2e3,global_timeout_ms:3e3,debug:!1,mode:"VISIT",initialized:!1},O={xandr:32,mediarithmics:184,google:755,id5:131},n=(S.prototype.fetchConfig=function(){var t="";this.options.site_token?t="?$site_token="+this.options.site_token+"&cb="+Date.now():this.options.datamart_token&&(t="?$dat_token="+this.options.datamart_token+"&cb="+Date.now());t=this.options.protocol+this.options.domain_name+this.options.config_server_path+t;this.options.js_mock_params&&(t=t+"&"+this.options.js_mock_params),(0,l.loadScript)(t)},S.prototype.fetchScriptFromUri=function(t){(0,l.loadScript)(this.options.protocol+this.options.domain_name+t)},S.prototype.fetchScriptFromUrl=function(t){(0,l.loadScript)(t)},S.prototype.addPixel=function(t){t=this.options.protocol+this.options.domain_name+t;this.console.debug("Will load pixelUrl ".concat(t)),this.options.override_transport?this.options.override_transport(t):(0,l.loadPixel)(t)},S.prototype.call=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=Array.prototype.slice.apply(e).splice(0);this.callMicsMethod(t,i)},S.prototype.callMicsMethod=function(t,e){["init","call","config","push","pushDefault","addIdentifier","addProperties","addProperty","onFinish","onStart","_reset","syncFeeds"].includes(t)?this[t].apply(this,e):this.console.error("The method '"+t+"' is not supported.")},S.prototype.onStart=function(t){t&&t.apply()},S.prototype.setOperatorId=function(t,e){this.cookieMatcher&&this.cookieMatcher.setOperatorId(t,e)},S.prototype.getParamOrElse=function(t,e,n){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:n},S.prototype.clearWatchDog=function(){this.eventPusher&&this.eventPusher.clearWatchDog()},S.prototype.getTagConfigOverride=function(){var e=this.cache.get("mics_tag_config_override");if(e)try{var t=JSON.parse(e);return this.console.log("Tag Config override found : ".concat(JSON.stringify(t))),t}catch(t){this.console.error("Cannot parse tag config override : ".concat(e))}return{}},S.prototype.getTagOptionsOverride=function(){var e=this.cache.get("mics_tag_options_override");if(e)try{var t=JSON.parse(e);return this.console.log("Tag options override found : ".concat(JSON.stringify(t))),t}catch(t){this.console.error("Cannot parse tag options override : ".concat(e))}return{}},S.prototype.setConfig=function(t){var e,n=this;this.options.initialized?void 0!==this.options.site_token&&t.site_token===this.options.site_token||void 0!==this.options.datamart_token&&t.dat_token===this.options.datamart_token?(this.console.info("Applying config for site token ".concat(this.options.site_token)),e=i(i({},t),this.getTagConfigOverride()),this.currentPage&&(this.console.info("setConfig",e),e.audience_feeds_refresh_period&&this.addProperties({$audience_feeds_refresh_period:e.audience_feeds_refresh_period}),this.enable_local_segment_evaluation=this.getParamOrElse(e,"enable_local_segment_evaluation",!1),this.namespace=e.namespace||"",this.segment_evaluator_uri=e.segment_evaluator_uri||"",this.segment_evaluator_url=e.segment_evaluator_url||"",this.segment_definition_url=e.segment_definition_url||"",this.segment_definition_uri=e.segment_definition_uri||"",this.user_agent_info=e.user_agent_info||{},this.enableGOOMatching=this.getParamOrElse(e,"enable_goo_matching",!0),this.enableAPXMatching=this.getParamOrElse(e,"enable_apx_matching",!0),this.enableTcfForCookieMatching=this.getParamOrElse(e,"enable_tcf_v2_for_cookie_matching",!1),this.enableID5=this.getParamOrElse(e,"enable_id5",!1),this.enableID5&&(this.eventPusher?this.id5IdGatherer=new y.default({context:this.context,userIdentifierHolder:this.userIdentifierHolder,debug:this.debug,initialId5ApiConfig:this.getParamOrElse(e,"id5-init-config-override",{})}):this.console.warn("enable_id5 is true but eventPusher is null, cannot start id5 gathering")),this.cookieMatcher&&this.cookieMatcher.setIsTcfEnabled(this.enableTcfForCookieMatching||!1),this.fetchUAID(this.currentPage.getCookie(),this.currentPage.getVid(),this.currentPage.getLts()),this.enable_local_segment_evaluation&&(this.userpoint=new g.UserPoint(function(t,e){n.addPixel("/v1/edge/pixel?%24site_token="+n.options.site_token+"&%24seg_id="+t+"&%24o=a&%24vid="+encodeURIComponent(e))},function(t,e){n.addPixel("/v1/edge/pixel?%24site_token="+n.options.site_token+"&%24seg_id="+t+"&%24o=d&%24vid="+encodeURIComponent(e))},function(){n.enable_local_segment_evaluation&&n.userpoint&&n.computeSegments()},this.options.debug,this.namespace),this.eventPusher&&this.eventPusher.setUserpoint(this.userpoint),e=this.userIdentifierHolder.findVectorIdLongValue(),this.console.info("vector id",e),this.fetchScriptFromUri("/v1/device_info.js"),e&&this.userpoint.setAgent(e,this.user_agent_info),this.segment_evaluator_uri?this.fetchScriptFromUri(this.segment_evaluator_uri):this.segment_evaluator_url&&this.fetchScriptFromUrl(this.segment_evaluator_url),this.segment_definition_uri?this.fetchScriptFromUri(this.segment_definition_uri):this.segment_definition_url&&this.fetchScriptFromUrl(this.segment_definition_url)))):this.console.debug("Will not apply config ".concat(JSON.stringify(t)," for this site token ").concat(this.options.site_token)):this.console.warn("Cannot apply setConfig before init was called")},S.prototype.markConfigAsLoaded=function(){var t;null!==(t=this.currentPage)&&void 0!==t&&t.markConfigAsLoaded(),null!==(t=this.eventPusher)&&void 0!==t&&t.triggerCallsIfPossible()},S.prototype.loadNetworkIdApiJs=function(n,i,o){return r(this,void 0,void 0,function(){var e=this;return s(this,function(t){switch(t.label){case 0:return[4,i];case 1:if(!t.sent())try{return[2,(0,l.loadScriptAsync)(o).then(function(){return e.console.info("Loaded ".concat(o))})]}catch(t){return this.console.error("Could not load ".concat(n," API"),t),[2,Promise.reject()]}return[2]}})})},S.prototype.setEvaluator=function(t){this.console.info("Setting Segment Evaluator"),"function"==typeof t&&(this.segment_evaluator=t),this.computeSegments()},S.prototype.setSegmentDefinition=function(t){this.console.info("Setting Segment Definition"),this.segment_definition=t.map,this.computeSegments()},S.prototype.setDeviceInfo=function(t){this.console.info("Setting Device Info"),this.device_info=t,this.userpoint&&this.userpoint.setAgent&&(this.userpoint.setAgent(this.userIdentifierHolder.findVectorIdLongValue(),this.device_info),this.computeSegments())},S.prototype.getConsentDate=function(t){var e=new Date,n=new Date(t),t=n.getTime();return 0<t&&t<e.getTime()?n:e},S.prototype.declareAdvertisingCookieConsent=function(t){var e=this.getConsentDate(t),n=24*this.options.cookie_max_age_in_days*60*60*1e3;this.cache.store(b,"true"),this.cache.store(w,e.getTime().toString());t=new Date;t.setTime(e.getTime()+n),(0,_.updateCookiesExpirationStartingWith)("mics_",t.toUTCString())},S.prototype.revokeAdvertisingCookieConsent=function(){this.cache.store(b,"false"),this.cache.remove(w),(0,_.deleteCookiesStartingWith)("mics_")},S.prototype._setUAID=function(t,e,n){this.currentPage&&(e&&!this.set&&(this.set=!0,this.console.log("_setUAID(",e,n,")",this.userpoint),this.currentPage.updateUAID(e,n),this.enable_local_segment_evaluation&&this.userpoint&&this.user_agent_info&&this.userpoint.setAgent(e,this.user_agent_info)),this.eventPusher&&this.eventPusher.triggerCallsIfPossible(),this.syncFeedsCb&&(this.syncFeedsCb(),this.syncFeedsCb=void 0))},S.prototype.upsertAdvertisingCookie=function(t,e,n,i){void 0===i&&(i=this.options.cookie_max_age_in_days);var o=new Date;o.setTime(o.getTime()+864e5*i);var i=null!==(i=(0,_.readCookie)("mics_"+e))&&void 0!==i?i:n,n="mum"===t||"vec"===t?void 0:e;this.userIdentifierHolder.addUserAgentIdentifier("".concat(t,":").concat(null!==(n=null==n?void 0:n.concat(":"))&&void 0!==n?n:"").concat(i));i=encodeURIComponent(i);document.cookie="mics_".concat(e,"=").concat(i,";expires=").concat(o.toUTCString(),";path=/")},S.prototype.hasPurposesConsents=function(t){return!!(t&&0<Object.keys(t).length&&Object.prototype.hasOwnProperty.call(t,"1")&&Object.prototype.hasOwnProperty.call(t,"3"))&&(t[1]&&t[3])},S.prototype.getVendorConsent=function(t,e){return!!(t&&0<Object.keys(t).length&&void 0!==t[e])&&t[e]},S.prototype.validateMode=function(t){if(!t||!E.includes(t))throw new Error("".concat(this.context,".init : invalid mode (").concat(t,")"))},S.prototype.handleTcfApi=function(){var n=this;window.__tcfapi&&(this.console.log("tcfapi detected"),window.__tcfapi("getTCData",2,function(t,e){e&&(n.tcfstr=t.tcString,n.gdprApplies=t.gdprApplies,t.purpose&&t.purpose.consents&&(n.tcfPurposesConsents=n.hasPurposesConsents(t.purpose.consents)),t.vendor&&t.vendor.consents&&(n.tcfVendorGoogleConsent=n.getVendorConsent(t.vendor.consents,n.vendorIds.google),n.tcfVendorXandrConsent=n.getVendorConsent(t.vendor.consents,n.vendorIds.xandr),n.tcfVendorMicsConsent=n.getVendorConsent(t.vendor.consents,n.vendorIds.mediarithmics)))}))},S.prototype.init=function(t){if(this.options.initialized)this.console.warn(this.context+" was already initialized, stop initialization");else{var e=this.initializeTagOptions(t);this.console.info("mcsObj.config, new configuration is",e),this.options=e,this.handleTcfApi();var n=null,t=null;if("VISIT"===e.mode?(n="/v1/visits/pixel",t=this.globalProperties.$site_token=e.site_token):"TOUCH"===e.mode&&(n="/v1/touches/pixel",t=this.globalProperties.$dat_token=e.datamart_token),"string"!=typeof t)throw new Error(this.context+".init : the token must be a string");if(0===t.length)throw new Error(this.context+".init : the token must be a non-empty string");this.options.initialized=!0,this.currentPage=new d.CurrentPage(e,this.userIdentifierHolder,this.gdprApplies,this.tcfstr),this.fetchConfig(),this.cookieMatcher=new a.CookieMatcher(e,this.tcfVendorMicsConsent,this.tcfPurposesConsents,this.gdprApplies,this.tcfstr),this.currentPage.readPage();n={endPointUrl:e.protocol+e.domain_name+n,debug:e.debug,overrideTransport:e.override_transport};this.eventPusher=new p.EventPusher(this.context,P,this.currentPage,this.cookieMatcher,this.userpoint,n,this.userIdentifierHolder),this.eventPusher.addProperties(this.globalProperties),this.eventPusher.setWatchDog(e.global_timeout_ms),this.cookieMatcher.panicCallback(this.eventPusher.panic.bind(this.eventPusher)),this.addProperty("$tv","2.0.20230214-build-115-rev-40f9d4a")}},S.prototype.pageQuit=function(){this.eventPusher&&this.eventPusher.pageQuit()},S.prototype.onFinish=function(t,e){this.eventPusher&&this.eventPusher.onFinish(t,e)},S.prototype.pushDefault=function(){this.push("$page_view")},S.prototype.push=function(t,e){if(!this.eventPusher)throw new Error(this.context+" is not initialized, call "+this.context+".init(YOUR_TOKEN) first !");this.eventPusher.push(t,e)},S.prototype.addProperty=function(t,e){var n;this.console.debug("addProperty",t,e),"$user_account_id"===t?this.userIdentifierHolder.legacyUserAccountId=e:"$comp_token"===t?this.userIdentifierHolder.legacyCompartmentToken=e:"$email_hash"===t?this.userIdentifierHolder.legacyEmailHash=e:"$email"===t?this.userIdentifierHolder.legacyEmail=e:this.addProperties(((n={})[t]=e,n))},S.prototype.addProperties=function(t){this.console.debug("addProperties",t),this.eventPusher?this.eventPusher.addProperties(t):this.globalProperties=(0,v.default)(this.globalProperties,t)},S.prototype.addIdentifier=function(t,e){this.console.debug("addIdentifier(".concat(t,", ").concat(JSON.stringify(e),")"));try{if("USER_ACCOUNT"!=t&&"USER_EMAIL"!=t)throw new Error("Unsupported identifier type ".concat(t,', valid types are "USER_ACCOUNT" and "USER_EMAIL"'));this._addIdentifier(t,e)}catch(t){this.console.error(t)}},S.prototype._addIdentifier=function(t,e){try{var n=null!==e&&"string"==typeof e?e:JSON.stringify(e);this.userIdentifierHolder.addIdentifierUnsafe(t,n)}catch(t){this.console.error(t)}},Object.defineProperty(S.prototype,"vid",{get:function(){return this.userIdentifierHolder.findVectorIdLongValue()},enumerable:!1,configurable:!0}),S.prototype._reset=function(){this.console.info("reset ",this.context),this.userpoint&&this.userpoint.reset(),this.set=!1,this.options=(0,v.default)({debug:this.options.debug},A),this.globalProperties={$sv:f.mics._snippetVersion},this.cookieMatcher=void 0,this.eventPusher=void 0,this.id5IdGatherer=void 0,this.currentPage=void 0,this.userpoint=void 0,this.userIdentifierHolder.reset(),this.tcfVendorXandrConsent=void 0,this.tcfVendorGoogleConsent=void 0,this.tcfVendorMicsConsent=void 0,this.tcfPurposesConsents=void 0,this.enableGOOMatching=void 0,(this.enableAPXMatching=void 0,_.deleteCookiesStartingWith)("mics_")},S.prototype.config=function(t){return this.options=(0,v.default)(this.options,t=t||{}),t.cookie_matching_url?this.console.info("overriding cookie_matching_url with ",t.cookie_matching_url):t.domain_name&&(this.options.cookie_matching_url=this.options.protocol+this.options.domain_name+this.options.get_id_path,this.console.info("using custom domain, cookie_matching_url will be ",this.options.cookie_matching_url)),this.console.info("mcsObj.config, new configuration is",this.options),this.options},S.prototype.syncFeeds=function(t){function e(){return(0,h.processExternalFeeds)(n.globalProperties.$audience_feeds_refresh_period,n.options.site_token,n.options.domain_name,t,n.userIdentifierHolder.findVectorIdLongValue(),n.options.override_transport||void 0)}var n=this;this.userIdentifierHolder.findVectorIdLongValue()?e():this.syncFeedsCb=e},S);function S(t,e){var a=this;this.enableID5=!1,this.fetchUAID=function(t,e,n){var i,o=new Date;o.setTime(o.getTime()-24*a.options.cookie_refresh_in_days*60*60*1e3);var r=[];!0===a.enableGOOMatching&&(!1===a.enableTcfForCookieMatching||!0===a.tcfVendorGoogleConsent&&!0===a.tcfVendorMicsConsent||!1===a.gdprApplies)&&r.push("goo"),!0===a.enableAPXMatching&&(!1===a.enableTcfForCookieMatching||!0===a.tcfVendorXandrConsent&&!0===a.tcfVendorMicsConsent||!1===a.gdprApplies)&&r.push("apx"),a.cookieMatcher&&a.cookieMatcher.setOperators(r),a.enable_local_segment_evaluation&&a.userpoint&&a.userpoint.getAgent&&(i=null===(i=a.userpoint)||void 0===i?void 0:i.getAgent()),e&&n&&(n>o.getTime()||i)?a._setUAID(t,e,n):a.cookieMatcher&&a.cookieMatcher.gatherOperatorsIds()},this.computeSegments=function(){var t,e,n,i,o,r,s=[];a.segment_definition&&a.segment_evaluator&&(e=null===(t=a.userpoint)||void 0===t?void 0:t.getUserPointData(),n=Object.keys(a.segment_definition),i=0,o=10,(r=function(){var t=i+o;n.slice(i,i+o).forEach(function(t){e&&a.segment_evaluator&&a.segment_evaluator(e,a.segment_definition[t])&&s.push(t)}),t<n.length?(i=t,setTimeout(r,100)):(a.console.info("Finished Computing Segments",s),a.userpoint&&a.userpoint.setSegments(s))})())},this.initializeTagOptions=function(t){var e;if(void 0===t)throw new Error(a.context+".init : use a token string or an object");return"string"==typeof t?e=I(a.options,{mode:"VISIT",site_token:t,domain_name:a.options.domain_name}):(a.validateMode(t.mode),e=I(a.options,t),t.cookie_matching_url?a.console.info("overriding cookie_matching_url with ",e.cookie_matching_url):t.domain_name&&(e.cookie_matching_url=e.protocol+e.domain_name+e.get_id_path,a.console.info("using custom domain, cookie_matching_url will be ",e.cookie_matching_url))),i(i({},e),a.getTagOptionsOverride())},this.context=t,this.namespace="",this.debug=e,this.console=(0,u.Console)(t,e),this.cache=new c.Cache(e),this.user_agent_info={},this.enable_local_segment_evaluation=!1,this.vendorIds=O,this.context=t,this.options=(0,v.default)(A,{debug:e}),this.globalProperties={$sv:f.mics._snippetVersion},this.get=l.get,this.processExternalFeeds=h.processExternalFeeds,this.processExternalFeedsWith=h.processExternalFeedsWith,this.userIdentifierHolder=new m.default(t,e),this.id5IdGatherer=void 0,this.syncFeedsCb=void 0,this.console.info("Creating tag object, globalProperties: ".concat(JSON.stringify(this.globalProperties)))}e.TagObject=n},8713:function(t,a,e){"use strict";var c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(a,"__esModule",{value:!0}),a.UserPoint=a.MAX_EVENTS_FOR_USER_POINT=a.BASE_SEGMENTS_STORAGE_KEY=a.BASE_USERPOINT_STORAGE_KEY=void 0;var u=e(6701),d=e(2461);a.BASE_USERPOINT_STORAGE_KEY="_mics_up",a.BASE_SEGMENTS_STORAGE_KEY="mics_sgmts",a.MAX_EVENTS_FOR_USER_POINT=200;var l={profiles:[],segments:[],activities:[],events:[],emails:[],agents:[]},e=(n.prototype.reset=function(){this.userPointData=l,this.cache.remove(this.namespace+a.BASE_USERPOINT_STORAGE_KEY),this.cache.remove(a.BASE_SEGMENTS_STORAGE_KEY)},n.prototype.getUserPointData=function(){return this.userPointData},n.prototype.saveUserpoint=function(){var t=this.encrypt(this.userPointData);this.cache.store(this.namespace+a.BASE_USERPOINT_STORAGE_KEY,t);var e=this.cache.get(a.BASE_SEGMENTS_STORAGE_KEY),t=this.getSegmentIds()?this.getSegmentIds():[];e&&"object"==typeof e?e[this.namespace]=t:(e={})[this.namespace]=t,this.cache.store(a.BASE_SEGMENTS_STORAGE_KEY,JSON.stringify(e)),this.console.info("Saving UserPoint",this.userPointData)},n.prototype.setAgent=function(t,e){this.console.debug("setAgent(".concat(t,",").concat(JSON.stringify(e),")"));var n=t,i=e;e&&e!=={}||(i=this.getUserAgentInfo()),(n=!t||""===t?this.getAgent():n)&&i&&(i={id:"vec:"+t,creation_date:Date.now(),creation_ts:Date.now(),user_agent_info:i},this.userPointData.agents=[i],this.saveUserpoint())},n.prototype.getUserAgentInfo=function(){return this.userPointData.agents&&this.userPointData.agents.length&&this.userPointData.agents[0].user_agent_info&&(void 0!==this.userPointData.agents[0].user_agent_info||this.userPointData.agents[0].user_agent_info!=={})?this.userPointData.agents[0].user_agent_info:void 0},n.prototype.getAgent=function(){var t=this.userPointData.agents||[];if(t.length&&t[0].id){t=t[0].id.split(":");return t[t.length-1]}},n.prototype.getVectorId=function(){return this.userPointData.agents&&this.userPointData.agents.length?this.userPointData.agents[0].id:null},n.prototype.getSegmentIds=function(){return this.userPointData.segments.map(function(t){return t.id}).map(String)},n.prototype.formatEvent=function(t){return t.name=t.$ev,t.referrer=t.$referrer,t.date=Date.now(),t.url=t.$url,t.site_token=t.$site_token,delete t.$web_domain_token,delete t.$web_domain_id,delete t.$etag_id,delete t.$vector_last_seen,delete t.$tag_version,delete t.$delay,delete t.$error,delete t.$snippet_version,delete t.$check_cookie_drop_param,delete t.$consent_from_tcf_api,delete t.$gdpr_consent,delete t.$gdpr_applies,delete t.$installation_id,Object.assign(t,t.properties)},n.prototype.encrypt=function(t){return JSON.stringify(t)},n.prototype.decrypt=function(t){return JSON.parse(t)},n);function n(t,e,n,i,o){var s=this;this.userPointData=c({},l),this.setSegments=function(t){s.console.debug("setSegments(".concat(JSON.stringify(t),")"));var n,i=s.getSegmentIds(),o=t.filter(function(e){return!i.find(function(t){return e===t})}),r=i.filter(function(e){return!t.find(function(t){return e===t})});0!==o.length||0!==r.length?(s.userPointData.segments=t.map(function(t){return{id:t,creation_ts:Date.now(),last_modified_ts:Date.now(),expiration_ts:null}}),s.console.info("New Segments",o,"Removed Segments",r,"segments",t),s.saveUserpoint(),(n=function(t){var e=s.getVectorId();e?(s.console.log("found vectorId: "+e),s.onAddition&&o.forEach(function(t){s.onAddition(t,e)}),s.onDeletion&&r.forEach(function(t){s.onDeletion(t,e)})):0<t&&(s.console.log("could not find vectorId. retries left: "+t),setTimeout(n,1e3,t-1))})(5)):s.console.log("No new addition nor deletion, skipping...")},this.addEvent=function(t){s.console.debug("addEvent(".concat(JSON.stringify(t),")"));t=s.formatEvent(t);s.userPointData.events.unshift(t),s.userPointData.events=s.userPointData.events.slice(0,a.MAX_EVENTS_FOR_USER_POINT),s.saveUserpoint(),s.onEvent()},this.namespace=o,this.onAddition=t,this.onDeletion=e,this.onEvent=n,this.console=(0,d.Console)("UserPoint",i),this.cache=new u.Cache(i),this.console.info("Starting UserPoint System");i=this.cache.get(this.namespace+a.BASE_USERPOINT_STORAGE_KEY);if(i)try{var r=this.decrypt(i);this.console.debug("Existing user point found in localStorage : ".concat(JSON.stringify(r))),this.userPointData=r}catch(t){this.console.error("Failed to parse userpoint data in localStorage")}}a.UserPoint=e},8118:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var r,s=n(2461),a=n(1296),c=n(2849),u=n(9124),n=n(9506),o=(r=n.UserIdentifierHolderWrapped,o(d,r),d.prototype.reset=function(){this._userIdentifiers=[],this.console.info("Reset user identifiers")},d.prototype.userIdentifiers=function(){return this.legacyUserAccountId&&this.withUserAccountIdentifier(this.legacyUserAccountId,this.legacyCompartmentToken),this.legacyEmailHash&&this.withUserEmailIdentifier(this.legacyEmailHash,this.legacyEmail),this._userIdentifiers},d.prototype.getEventPusherProperties=function(){return{$uids:this.userIdentifiers().map(function(t){return t.toQueryObject()})}},d.prototype.withUserAccountIdentifier=function(t,e){return this.withIdentifier(new a.UserAccountIdentifierJson(t,e))},d.prototype.withUserEmailIdentifier=function(t,e){return this.withIdentifier(new c.UserEmailIdentifierJson(t,e))},d.prototype.withUserAgentIdentifier=function(t){try{return this.withIdentifier(new u.UserAgentIdentifierJson(t))}catch(t){this.console.error(t)}return{holder:this}},d.prototype.findVectorIdLongValue=function(){var t=null===(t=this.userIdentifiers().find(function(t){return t instanceof u.UserAgentIdentifierJson&&t.isVectorId()}))||void 0===t?void 0:t.getAgentId();return null==t?void 0:t.split(":")[1]},d.prototype.withIdentifier=function(e){return this._userIdentifiers.find(function(t){return t.equals(e)})?{holder:this}:(this._userIdentifiers.push(e),this.console.log("New identifier ".concat(JSON.stringify(e)," added to user_identifiers ").concat(JSON.stringify(this.userIdentifiers()))),{holder:this,identifier:e})},d.prototype.withIdentifierUnsafe=function(t,e){this.console.debug("withIdentifierUnsafe(".concat(t,", ").concat(e,")"));t=this.getFactory(t);if(t)try{return this.withIdentifier(t.fromObjectUnsafe(JSON.parse(e)))}catch(t){this.console.error("An unexpected error occurred while calling withIdentifierUnsafe: ".concat(t))}return{holder:this}},d.prototype.getFactory=function(t){var e;return"USER_ACCOUNT"===t?e=new a.UserAccountIdentifierJsonFactory:"USER_EMAIL"===t?e=new c.UserEmailIdentifierJsonFactory:"USER_AGENT"===t?e=new u.UserAgentIdentifierJsonFactory:(e=void 0,this.console.warn("Unhandled identifier type ".concat(t))),e},d);function d(t,e,n){var i=r.call(this)||this;return i._userIdentifiers=[],i.console=(0,s.Console)("ArrayBasedUserIdentifierHolder-".concat(e),!!n),t.vid&&i._userIdentifiers.push(new u.UserAgentIdentifierJson(t.vid)),i.legacyUserAccountId=t.legacyUserAccountId,i.legacyCompartmentToken=t.legacyCompartmentToken,i.legacyEmailHash=t.legacyEmailHash,i.legacyEmail=t.legacyEmail,i}e.default=o},4172:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s,a=n(2461),c=r(n(8118)),u=n(9124),n=n(9506),o=(s=n.UserIdentifierHolderWrapped,o(d,s),d.prototype.reset=function(){this.legacyUserAccountId=void 0,this.legacyCompartmentToken=void 0,this.legacyEmailHash=void 0,this.legacyEmail=void 0,this.console.info("Reset user identifiers")},d.prototype.getEventPusherProperties=function(){var t={},e=this.findVectorIdLongValue();return e&&(t.$vid=e),this.legacyUserAccountId&&(t.$cuid=this.legacyUserAccountId),this.legacyCompartmentToken&&(t.$comp_token=this.legacyCompartmentToken),this.legacyEmailHash&&(t.$email_hash=this.legacyEmailHash),this.legacyEmail&&(t.$email=this.legacyEmail),t},d.prototype.userIdentifiers=function(){return new c.default(this,this.context,this.debug).userIdentifiers()},d.prototype.findVectorIdLongValue=function(){var t;return null===(t=this.vid)||void 0===t?void 0:t.split(":")[1]},d.prototype.withUserAccountIdentifier=function(t,e){return new c.default(this,this.context,this.debug).withUserAccountIdentifier(t,e)},d.prototype.withUserAgentIdentifier=function(t){if(this.isVectorId(t)){var e=new u.UserAgentIdentifierJson(t);return e.getAgentId()!==this.vid?(this.vid=e.getAgentId(),{holder:this,identifier:new u.UserAgentIdentifierJson(t)}):{holder:this}}return new c.default(this,this.context,this.debug).withUserAgentIdentifier(t)},d.prototype.withUserEmailIdentifier=function(t,e){return new c.default(this,this.context,this.debug).withUserEmailIdentifier(t,e)},d.prototype.withIdentifierUnsafe=function(t,e){return new c.default(this,this.context,this.debug).withIdentifierUnsafe(t,e)},d.prototype.isVectorId=function(t){var e=t.split(":"),n=new RegExp(/^\d+$/);return 1==e.length&&n.test(t)||2==e.length&&n.test(e[1])},d);function d(t,e){var n=s.call(this)||this;return n.context=t,n.debug=!!e,n.console=(0,a.Console)("PropertiesBasedUserIdentifierHolder-".concat(t),!!e),n}e.default=o},1296:function(t,e){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.UserAccountIdentifierJsonFactory=e.UserAccountIdentifierJson=e.UserAccountIdentifier=void 0;var o=function(t,e){this.$user_account_id=t,this.$compartment_token=e};e.UserAccountIdentifier=o;var r,s=(n(a,r=o),a.prototype.equals=function(t){return t instanceof a&&(t.$user_account_id===this.$user_account_id&&t.$compartment_token===this.$compartment_token)},a.prototype.toQueryObject=function(){return{$tpe:"AC",$acid:this.$user_account_id,$ctok:this.$compartment_token}},a.prototype.toMappingEvent=function(){return{$type:"USER_ACCOUNT",$user_account_id:this.$user_account_id,$compartment_token:this.$compartment_token}},a);function a(t,e){e=r.call(this,t,e)||this;return e.$type="USER_ACCOUNT",e}e.UserAccountIdentifierJson=s;c.prototype.fromObjectUnsafe=function(t){if(t.$user_account_id)return new s(t.$user_account_id,t.$compartment_token);throw Error("".concat(t," is not does not have $user_account_id property"))},o=c;function c(){}e.UserAccountIdentifierJsonFactory=o},9124:function(t,e){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.UserAgentIdentifierJsonFactory=e.UserAgentIdentifierJson=void 0;var o,r={vec:"MEDIARITHMICS_USER_MAPPING_ID",mum:"MEDIARITHMICS_USER_MAPPING_ID",ins:"INSTALLATION_ID",tech:"TECHNICAL_ID",web:"ORGANISATION_OWNED_ID",etag:"ETAG",mob:"MOBILE_ADVERTISING_ID",net:"NETWORK_DEVICE_ID",dev:"CUSTOM_ID"},s=(n(a,o=function(t){if(new RegExp(/^\d+$/).test(t))this.$user_agent_id="vec:".concat(t);else{if(!Object.keys(r).includes(t.split(":")[0]))throw Error("Unknown user agent id ".concat(t));this.$user_agent_id=t}}),a.prototype.equals=function(t){return t instanceof a&&t.$user_agent_id===this.$user_agent_id},a.prototype.isVectorId=function(){return this.$user_agent_id.startsWith("vec:")},a.prototype.getAgentId=function(){return this.$user_agent_id},a.prototype.toQueryObject=function(){return{$tpe:"AG",$agid:this.$user_agent_id}},a.prototype.toMappingEvent=function(){var t=this.getAgentId().split(":"),e=r[t[0]];return"MEDIARITHMICS_USER_MAPPING_ID"===e?{$type:e,$registry_token:1,$value:this.getAgentId(),$id:t[1]}:{$type:e,$registry_token:t[1],$value:this.getAgentId(),$id:t.splice(2).join(":")}},a);function a(t){t=o.call(this,t)||this;return t.$type="USER_AGENT",t}e.UserAgentIdentifierJson=s;c.prototype.fromObjectUnsafe=function(t){if(t.$user_agent_id)return new s(t.$user_agent_id);throw Error("".concat(t," is not does not have $user_agent_id property"))},n=c;function c(){}e.UserAgentIdentifierJsonFactory=n},2849:function(t,e){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.UserEmailIdentifierJsonFactory=e.UserEmailIdentifierJson=e.UserEmailIdentifier=void 0;var o=(r.prototype.getEmailHash=function(){return this.$email_hash},r);function r(t,e){this.$email_hash=t,this.$email=e}e.UserEmailIdentifier=o;var s,a=(n(c,s=o),c.prototype.equals=function(t){return t instanceof c&&t.$email_hash===this.$email_hash},c.prototype.toQueryObject=function(){return{$tpe:"EM",$eh:this.$email_hash,$e:this.$email}},c.prototype.toMappingEvent=function(){return{$type:"USER_EMAIL",$email_hash:this.$email_hash,$email:this.$email}},c);function c(t,e){e=s.call(this,t,e)||this;return e.$type="USER_EMAIL",e}e.UserEmailIdentifierJson=a;u.prototype.fromObjectUnsafe=function(t){if(t.$email_hash)return new a(t.$email_hash,t.$email);throw Error("".concat(t," is not does not have $email_hash property"))},o=u;function u(){}e.UserEmailIdentifierJsonFactory=o},4951:function(t,e,n){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(4172)),r=n(2461),n=(s.prototype.reset=function(){this.internal=new o.default(this.context,this.debug)},Object.defineProperty(s.prototype,"legacyUserAccountId",{set:function(t){this.internal.legacyUserAccountId=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"legacyCompartmentToken",{set:function(t){this.internal.legacyCompartmentToken=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"legacyEmailHash",{set:function(t){this.internal.legacyEmailHash=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"legacyEmail",{set:function(t){this.internal.legacyEmail=t},enumerable:!1,configurable:!0}),s.prototype.getEventPusherProperties=function(){return this.internal.getEventPusherProperties()},s.prototype.userIdentifiers=function(){return this.internal.userIdentifiers()},s.prototype.hasIdentifiers=function(){return 0<this.internal.userIdentifiers().length},s.prototype.findVectorIdLongValue=function(){return this.internal.findVectorIdLongValue()},s.prototype.addIdentifierUnsafe=function(t,e){e=this.internal.withIdentifierUnsafe(t,e);this.internal=e.holder,e.identifier&&this.onNewIdentifier(e.identifier)},s.prototype.addUserAccountIdentifier=function(t,e){e=this.internal.withUserAccountIdentifier(t,e);this.internal=e.holder,e.identifier&&this.onNewIdentifier(e.identifier)},s.prototype.addUserEmailIdentifier=function(t,e){e=this.internal.withUserEmailIdentifier(t,e);this.internal=e.holder,e.identifier&&this.onNewIdentifier(e.identifier)},s.prototype.addUserAgentIdentifier=function(t){t=this.internal.withUserAgentIdentifier(t);this.internal=t.holder,t.identifier&&this.onNewIdentifier(t.identifier)},s);function s(t,e){this.onNewIdentifier=function(){},this.context=t,this.debug=!!e,this.console=(0,r.Console)("UserIdentifierHolder-".concat(t),!!e),this.internal=new o.default(t,e)}e.default=n},9506:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UserIdentifierHolderWrapped=void 0,e.UserIdentifierHolderWrapped=function(){}}},i={};function o(t){var e=i[t];if(void 0!==e)return e.exports;e=i[t]={id:t,loaded:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.loaded=!0,e.exports}o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);o(2707)})();